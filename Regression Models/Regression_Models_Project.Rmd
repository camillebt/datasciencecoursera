---
title: 'Regression Models: Transmission Type Effect on MPG'
author: "Camille Tolentino"
date: "10/24/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Executive Summary

Motor Trend is an automobile magazine interested in exploring the factors that affect the miles per gallon or MPG.  In particular, in this report, we look at the impact of transmission type (automatic and manual) to MPG and quantify the difference if any. To summarize the findings, we note that manual transmission cars show $2.94$ MPG lead over automatics when considering the confounding variables weight and acceleration capacity.


# Exploratory Analysis

### Loading the Data

We will be using a built in dataset ```mtcars```. 

```{r,LoadData}
data(mtcars)
head(mtcars,3)
```

The columns are interpreted as follows:

```mpg``` Miles per Gallon  
```cyl``` Number of cylinders  
```disp``` Displacement  
```qsec``` 1/4 mile time  
```am``` Type of transmission where 0 = automatic and 1 = manual  
```wt``` Weight  


To make use of the ```am``` column as factor, we do a conversion and rename the levels to make it more intuitive.

```{r,asFactor}
mtcars$am <- as.factor(mtcars$am)
levels(mtcars$am)<-c("Auto","Manual")
```


To get a general idea of what the MPG trend is based on transmission type, we can look at the below boxplot.  

```{r,initBoxplot}
library(ggplot2)
ggplot(mtcars, aes(x = am,y = mpg))+
  geom_boxplot(aes(fill =am))+
  labs(x ="Transmission Type",
       y = "MPG",
       title = "Manual vs Automatic Transmission: MPG")+
  scale_fill_discrete(labels = c("Automatic", "Manual"))
  
```

Visually, the difference seems significant.  We can use the t test to formalize that the difference is significant.  We let our null hypothesis be that the two means are not significantly different.

```{r}
t.test(mtcars$mpg[mtcars$am=="Auto"],mtcars$mpg[mtcars$am=="Manual"])
```

With the p-value $0.00134 < 0.05$, we can conclude that at 95% confidence, we can reject the null hypothesis and that the means are significantly different.  

# Regresion Analysis

Now that we know there is significant difference in MPG between transmission types, we want to assign a number to quantify that difference.  To do this, we'll be using various methods: simple linear regression and multivariable linear regression.  We then check for the significance of the varibles considered in the multivariable regression in predicting MPG. 

## Simple Linear Regression

We want to see the slope of the line generated by a linear model to see how much difference is made by shifting from automatic to manual. 

```{r,simpLinear}
lmFit <- lm(mpg ~ am,mtcars)
summary(lmFit)
```

From the results above, we see that from automatic to manual we have a $7.245$ change in MPG.  The $R^2$ value, however, tells us that this model explains only $36%$ of the variance in MPG.  The change, therefore, can be attributed to other variables correlated with transmission type.

## Multi-Variable Linear Regression

We want to see which variables do we have to consider in order to get the full picture of the effect of transmission type. To do this we do a step linear regression to find the other variables that contribute to change in MPG.

```{r,stepLM,results='hide'}
stepLM <- step(lm(mpg~.,data=mtcars),direction="both")
```

```{r}
summary(stepLM) 
```


This shows us taht we want wt and qsec along with am to predict mpg. The 85% $R^2$ value we have with the multivariable regression suggests that this model is a better predictor of mpg than just the transmission type.  Since we currently have different values for the transmission type coefficient, we can run an ANOVA test on the two models. 

Let our null hypothesis be that adding ```wt``` and ```qsec``` to our model will not change it significantly enough. 

```{r,anova}
simpleLM <- lm(mpg ~ am, mtcars)
multiLM <- lm(mpg ~ am + wt + qsec, mtcars)
anova(simpleLM, multiLM)
```

With the p-value so close to 0, the ANOVA tells us that we should reject the null hypothesis and take the model with ```wt``` and ```qsec``` included.

# Conclusion

From the tests above, when we hold the weight and acceleration capacity of a car constant, manual transmission cars offer a $2.94$ MPG lead over automatics. 

# Appendix

## Correlation Plot of Variables

```{r}
pairs(mpg ~ ., data = mtcars)
```


## Diagnostic Plots

```{r,plots, echo = FALSE}
layout(matrix(1:4,2,2))
plot(multiLM)
```

## Step on Linear Model

```{r}
stepLM <- step(lm(mpg~.,data=mtcars),direction="both")
```



